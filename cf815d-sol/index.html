<!DOCTYPE html>
<html>
<head hexo-theme='https://volantis.js.org/#2.2.1'>
  <meta charset="utf-8">
  <!-- SEO相关 -->
  
    
  
  <!-- 渲染优化 -->
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- 页面元数据 -->
  
    <title>「Codeforces 815D」Karen and Cards - AutumnKite&#39;s Blog</title>
  
    <meta name="keywords" content="三维数点,单调性">
  
  
    <meta name="description" content="题目传送门
Karen and Cards
Karen just got home from the supermarket, and is getting ready to go to sleep.">
  

  <!-- feed -->
  

  <!-- import meta -->
  

  <!-- link -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css">
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.css">

  

  
  <link rel="shortcut icon" type='image/x-icon' href="/files/favicon-32x32.png">
  

  

  <!-- import link -->
  

  
    
<link rel="stylesheet" href="/css/style.css">

  

  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>

  
  
  
    <!-- 加载 KaTeX -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <!-- The loading of KaTeX is deferred to speed up page rendering -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <!-- To automatically render math in text elements, include the auto-render extension: -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
  
</head>

<body>
  
  <div class="cover-wrapper">
    
      <cover class='cover post half'>
        <div class='cover-body'>
  <div class='a'>
    
    
      <p class="title">AutumnKite's Blog</p>
    
    
      <p class="subtitle">一个 ZJ 小蒟蒻的博客</p>
    
  </div>
  <div class='b'>
    
      <div class="m_search">
        <form name="searchform" class="form u-search-form">
          <input type="text" class="input u-search-input" placeholder="搜索" />
          <i class="icon fas fa-search fa-fw"></i>
        </form>
      </div>
    
    <div class='menu navigation'>
      <ul class='h-list'>
        
          
            <li>
              <a class="nav home"
                href="/"
                
                
                id="home">
                <i class='fas fa-home fa-fw'></i>&nbsp;首页
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="/categories/"
                
                
                id="categories">
                <i class='fas fa-folder-open fa-fw'></i>&nbsp;分类
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="/tags/"
                
                
                id="tags">
                <i class='fas fa-tags fa-fw'></i>&nbsp;标签
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="/archives/"
                
                
                id="archives">
                <i class='fas fa-archive fa-fw'></i>&nbsp;时间轴
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="/friends/"
                
                
                id="friends">
                <i class='fas fa-link fa-fw'></i>&nbsp;友链
              </a>
            </li>
          
            <li>
              <a class="nav home"
                href="/about/"
                
                
                id="about">
                <i class='fas fa-user fa-fw'></i>&nbsp;关于
              </a>
            </li>
          
        
      </ul>
    </div>
  </div>
</div>

      </cover>
    
    <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>
<header class="l_header shadow floatable blur">

  <div class='wrapper'>
    <div class='nav-sub'>
      <a class="logo flat-box"></a>
      <ul class='switcher h-list'>
        <li><a class="s-comment flat-btn fas fa-comments fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
          <li><a class="s-toc flat-btn fas fa-list fa-fw" target="_self" href='javascript:void(0)'></a></li>
        
      </ul>
    </div>
		<div class="nav-main">
      
        
        <a class="logo flat-box" target="_self" href='/'>
          
          
          
            AutumnKite's Blog
          
          
        </a>
      

      

			<div class='menu navigation'>
				<ul class='h-list'>
          
          
          
            
            
              <li>
                <a class="flat-box" href=/
                  
                  
                  
                    id="home"
                  >
                  
                    <i class='fas fa-rss fa-fw'></i>
                  
                  博客
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/categories/
                  
                  
                  
                    id="categories"
                  >
                  
                    <i class='fas fa-folder-open fa-fw'></i>
                  
                  分类
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/tags/
                  
                  
                  
                    id="tags"
                  >
                  
                    <i class='fas fa-tags fa-fw'></i>
                  
                  标签
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/archives/
                  
                  
                  
                    id="archives"
                  >
                  
                    <i class='fas fa-archive fa-fw'></i>
                  
                  归档
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/friends/
                  
                  
                  
                    id="friends"
                  >
                  
                    <i class='fas fa-link fa-fw'></i>
                  
                  友链
                </a>
                
              </li>
            
          
          
            
            
              <li>
                <a class="flat-box" href=/about/
                  
                  
                  
                    id="about"
                  >
                  
                    <i class='fas fa-user fa-fw'></i>
                  
                  关于
                </a>
                
              </li>
            
          
          
				</ul>
			</div>

      
        <div class="m_search">
          <form name="searchform" class="form u-search-form">
            <i class="icon fas fa-search fa-fw"></i>
            <input type="text" class="input u-search-input" placeholder="搜索" />
          </form>
        </div>
      

			<ul class='switcher h-list'>
				
					<li><a class="s-search flat-btn fas fa-search fa-fw" target="_self" href='javascript:void(0)'></a></li>
				
				<li><a class="s-menu flat-btn fas fa-bars fa-fw" target="_self" href='javascript:void(0)'></a></li>
			</ul>
		</div>
	</div>
</header>
<ul class="menu-phone navigation white-box">
  
  
    <li>
      <a class="flat-box" href=/
        
        
        
          id="home"
        >
        
          <i class='fas fa-rss fa-fw'></i>
        
        博客
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/categories/
        
        
        
          id="categories"
        >
        
          <i class='fas fa-folder-open fa-fw'></i>
        
        分类
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/tags/
        
        
        
          id="tags"
        >
        
          <i class='fas fa-tags fa-fw'></i>
        
        标签
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/archives/
        
        
        
          id="archives"
        >
        
          <i class='fas fa-archive fa-fw'></i>
        
        归档
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/friends/
        
        
        
          id="friends"
        >
        
          <i class='fas fa-link fa-fw'></i>
        
        友链
      </a>
    </li>
  
    <li>
      <a class="flat-box" href=/about/
        
        
        
          id="about"
        >
        
          <i class='fas fa-user fa-fw'></i>
        
        关于
      </a>
    </li>
  
</ul>
<script>setLoadingBarProgress(40);</script>

  </div>


  <div class="l_body">
    <div class='body-wrapper'>
      

<div class='l_main'>
  

  
    <article id="post" class="post white-box shadow floatable article-type-post" itemscope itemprop="blogPost">
      


  <section class='meta'>
    
    
    <div class="meta" id="header-meta">
      
        
  
    <h1 class="title">
      <a href="/cf815d-sol/">
        「Codeforces 815D」Karen and Cards
      </a>
    </h1>
  


      
      <div class='new-meta-box'>
        
          
        
          
            
<div class='new-meta-item author'>
  <a href="https://autumnkite.github.io/" target="_blank" rel="nofollow noopener">
    <img src="/files/logo.png">
    <p>AutumnKite</p>
  </a>
</div>

          
        
          
            <div class="new-meta-item date">
  <a class='notlink'>
    <i class="fas fa-calendar-alt fa-fw" aria-hidden="true"></i>
    <p>发布于：2018年9月9日</p>
  </a>
</div>

          
        
          
            
  
  <div class='new-meta-item category'>
    <a href='/categories/%E9%A2%98%E8%A7%A3/Codeforces/' rel="nofollow">
      <i class="fas fa-folder-open fa-fw" aria-hidden="true"></i>
      <p>题解&nbsp;/&nbsp;Codeforces</p>
    </a>
  </div>


          
        
          
            
  
    <div class="new-meta-item browse busuanzi">
      <a class='notlink'>
        <i class="fas fa-eye fa-fw" aria-hidden="true"></i>
        <p>
          <span id="busuanzi_value_page_pv">
            <i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i>
          </span>
        </p>
      </a>
    </div>
  


          
        
          
            
  <div class="new-meta-item wordcount">
    <a class='notlink'>
      <i class="fas fa-keyboard fa-fw" aria-hidden="true"></i>
      <p>字数：1.4k字</p>
    </a>
  </div>
  <div class="new-meta-item readtime">
    <a class='notlink'>
      <i class="fas fa-hourglass-half fa-fw" aria-hidden="true"></i>
      <p>时长：7分钟</p>
    </a>
  </div>


          
        
          
            

          
        
      </div>
      
        <hr>
      
    </div>
  </section>


      <section class="article typo">
        <div class="article-entry" itemprop="articleBody">
          
          <p><a href="https://codeforces.com/problemset/problem/815/D" target="_blank" rel="noopener">题目传送门</a></p>
<h2 id="karen-and-cards">Karen and Cards</h2>
<p>Karen just got home from the supermarket, and is getting ready to go to sleep.</p>
<a id="more"></a>
<figure>
<img src="http://codeforces.com/predownloaded/2b/98/2b98bfcf516f93477a5a209118c7c4582fc9db2d.png" alt="" /><figcaption>img</figcaption>
</figure>
<p>After taking a shower and changing into her pajamas, she looked at her shelf and saw an album. Curious, she opened it and saw a trading card collection.</p>
<p>She recalled that she used to play with those cards as a child, and, although she is now grown-up, she still wonders a few things about it.</p>
<p>Each card has three characteristics: strength, defense and speed. The values of all characteristics of all cards are positive integers. The maximum possible strength any card can have is <span class="math inline">\(p\)</span>, the maximum possible defense is <span class="math inline">\(q\)</span> and the maximum possible speed is <span class="math inline">\(r\)</span>.</p>
<p>There are <span class="math inline">\(n\)</span> cards in her collection. The <span class="math inline">\(i\)</span>-th card has a strength <span class="math inline">\(a_i\)</span>, defense <span class="math inline">\(b_i\)</span> and speed <span class="math inline">\(c_i\)</span>, respectively.</p>
<p>A card beats another card if at least two of its characteristics are strictly greater than the corresponding characteristics of the other card.</p>
<p>She now wonders how many different cards can beat all the cards in her collection. Two cards are considered different if at least one of their characteristics have different values.</p>
<h3 id="input">Input</h3>
<p>The first line of input contains four integers, <span class="math inline">\(n,p,q\)</span> and <span class="math inline">\(r\)</span> (<span class="math inline">\(1 \le n,p,q,r \le 500000\)</span>), the number of cards in the collection, the maximum possible strength, the maximum possible defense, and the maximum possible speed, respectively.</p>
<p>The next <span class="math inline">\(n\)</span> lines each contain three integers. In particular, the <span class="math inline">\(i\)</span>-th line contains <span class="math inline">\(a_i,b_i\)</span> and <span class="math inline">\(c_i\)</span> (<span class="math inline">\(1\le a_i\le p,1\le b_i\le q,1\le c_i\le r\)</span>), the strength, defense and speed of the <span class="math inline">\(i\)</span>-th collection card, respectively.</p>
<h3 id="output">Output</h3>
<p>Output a single integer on a line by itself, the number of different cards that can beat all the cards in her collection.</p>
<h3 id="examples">Examples</h3>
<h4 id="input-1">Input</h4>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">3 </span><span class="number">4</span> <span class="number">4</span> <span class="number">5</span></span><br><span class="line"><span class="symbol">2 </span><span class="number">2</span> <span class="number">5</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">3</span> <span class="number">4</span></span><br><span class="line"><span class="symbol">4 </span><span class="number">1</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="output-1">Output</h4>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>
<h4 id="input-2">Input</h4>
<figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">5 </span><span class="number">10</span> <span class="number">10</span> <span class="number">10</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">1</span> <span class="number">1</span></span><br><span class="line"><span class="symbol">1 </span><span class="number">1</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="output-2">Output</h4>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">972</span></span><br></pre></td></tr></table></figure>
<h3 id="note">Note</h3>
<p>In the first test case, the maximum possible strength is 4, the maximum possible defense is 4 and the maximum possible speed is 5. Karen has three cards:</p>
<ul>
<li>The first card has strength 2, defense 2 and speed 5.</li>
<li>The second card has strength 1, defense 3 and speed 4.</li>
<li>The third card has strength 4, defense 1 and speed 1.</li>
</ul>
<p>There are 10 cards that beat all the cards here:</p>
<ol type="1">
<li>The card with strength 3, defense 3 and speed 5.</li>
<li>The card with strength 3, defense 4 and speed 2.</li>
<li>The card with strength 3, defense 4 and speed 3.</li>
<li>The card with strength 3, defense 4 and speed 4.</li>
<li>The card with strength 3, defense 4 and speed 5.</li>
<li>The card with strength 4, defense 3 and speed 5.</li>
<li>The card with strength 4, defense 4 and speed 2.</li>
<li>The card with strength 4, defense 4 and speed 3.</li>
<li>The card with strength 4, defense 4 and speed 4.</li>
<li>The card with strength 4, defense 4 and speed 5.</li>
</ol>
<p>In the second test case, the maximum possible strength is 10, the maximum possible defense is 10 and the maximum possible speed is 10. Karen has five cards, all with strength 1, defense 1 and speed 1.</p>
<p>Any of the 972 cards which have at least two characteristics greater than 1 can beat all of the cards in her collection.</p>
<h2 id="problem">Problem</h2>
<p>给定<span class="math inline">\(n\)</span>个三元组<span class="math inline">\((a_i,b_i,c_i)\)</span>，以及三元组中每个数的上限<span class="math inline">\(p,q,r\)</span>，定义一个三元组能击败另一个三元组当且仅当这个三元组中有任意两个数<strong>严格大于</strong>另一个三元组<strong>对应</strong>的两个数。求有多少三元组能击败所有<span class="math inline">\(n\)</span>个三元组。</p>
<h2 id="solution">Solution</h2>
<p>记满足条件的三元组为<span class="math inline">\((x,y,z)\)</span>。显然如果枚举<span class="math inline">\(x\)</span>，则三元组可以分为两类：<span class="math inline">\(a_i&lt;x\)</span>与<span class="math inline">\(a_i\ge x\)</span>。对于<span class="math inline">\(a_i&lt;x\)</span>的三元组，只需要满足<span class="math inline">\(y&gt;b_i\)</span><strong>或者</strong><span class="math inline">\(z&gt;c_i\)</span>。而对于<span class="math inline">\(a_i\ge x\)</span>的三元组，需要满足<span class="math inline">\(y&gt;b_i\)</span><strong>并且</strong><span class="math inline">\(z&gt;c_i\)</span>。</p>
<p>记<span class="math inline">\(smx_j(j\in [1,q])\)</span>表示<span class="math inline">\(b_i\ge j\)</span>的三元组中最大的<span class="math inline">\(c_i\)</span>，<span class="math inline">\(mx3\)</span>表示<span class="math inline">\(a_i\ge x\)</span>的三元组中最大的<span class="math inline">\(c_i\)</span>。那么<span class="math inline">\(z\)</span>的方案数就是<span class="math inline">\(r-max(smx_y,mx3)\)</span>，即<span class="math inline">\(z\)</span>需要满足<span class="math inline">\(z&gt;smx_y,z&gt;mx3\)</span>，因为对于<span class="math inline">\(a_i\ge x\)</span>的三元组，<span class="math inline">\(z\)</span>一定大于<span class="math inline">\(c_i\)</span>，且对于<span class="math inline">\(b_i\ge y\)</span>的三元组，<span class="math inline">\(z\)</span>也一定大于<span class="math inline">\(c_i\)</span>。</p>
<p>记<span class="math inline">\(mx2\)</span>表示<span class="math inline">\(a_i\ge x\)</span>的三元组中最大的<span class="math inline">\(b_i\)</span>，那么当<span class="math inline">\(x\)</span>固定时，总方案可以用<code>for (int i=mx2+1;i&lt;=q;i++) ans+=r-max(smx[i],mx3);</code>进行统计。</p>
<p>这样的话，因为我们要统计<span class="math inline">\(a_i\ge x\)</span>的三元组中最大的<span class="math inline">\(b_i\)</span>（<span class="math inline">\(mx2\)</span>），最大的<span class="math inline">\(c_i\)</span>（<span class="math inline">\(mx3\)</span>），所以我们应该倒着枚举<span class="math inline">\(x\)</span>。</p>
<p>时间复杂度？<span class="math inline">\(\mathcal O(n^2)\)</span>。显然不能过。</p>
<p>考虑优化<code>for (int i=mx2+1;i&lt;=q;i++) ans+=r-max(smx[i],mx3);</code>这段代码。</p>
<p><span class="math inline">\(max\)</span>很不好处理，我们考虑把它拆开分别计算。由<span class="math inline">\(smx_i\)</span>的定义可得，<span class="math inline">\(\{smx_i\}\)</span>单调不升，也就是<span class="math inline">\(i\)</span>越小，<span class="math inline">\(smx_i\)</span>越大。那么我们找到一个<span class="math inline">\(max\)</span>分界线，记为<span class="math inline">\(k\)</span>，使得<span class="math inline">\(i\ge k\)</span>时，<span class="math inline">\(smx_i\le mx3\)</span>，<span class="math inline">\(i&lt;k\)</span>时，<span class="math inline">\(smx_i&gt;mx3\)</span>。于是就可以<span class="math inline">\(\mathcal O(1)\)</span>计算答案了，用前缀和维护<span class="math inline">\(\{smx_i\}\)</span>的区间和即可。</p>
<p>显然，<span class="math inline">\(\{smx_i\},mx2,mx3\)</span>很容易维护。那么<span class="math inline">\(k\)</span>怎么办呢？因为<span class="math inline">\(x\)</span>从大到小枚举，<span class="math inline">\(mx3\)</span>会逐渐变大，而<span class="math inline">\(\{smx_i\}\)</span>单调不升，所以<span class="math inline">\(k\)</span>慢慢变小（向前），一直维护即可。</p>
<p>一些细节具体见代码。</p>
<h2 id="source">Source</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cctype&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> f=<span class="number">1</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">for</span> (;!<span class="built_in">isdigit</span>(ch)&amp;&amp;ch!=EOF;ch=getchar()) <span class="keyword">if</span> (ch==<span class="string">'-'</span>) f=<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (;<span class="built_in">isdigit</span>(ch);ch=getchar()) x=(x&lt;&lt;<span class="number">3</span>)+(x&lt;&lt;<span class="number">1</span>)+(ch^<span class="string">'0'</span>);</span><br><span class="line">    <span class="keyword">return</span> x*f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">500005</span>;</span><br><span class="line"><span class="keyword">int</span> n,La,Lb,Lc,smx[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">card</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> b,c;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;card&gt; d[N];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> ans,sum[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    n=read(),La=read(),Lb=read(),Lc=read(); <span class="comment">//La,Lb,Lc分别代表p,q,r</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)&#123;</span><br><span class="line">        <span class="keyword">int</span> a=min(La,read()),b=min(Lb,read()),c=min(Lc,read());</span><br><span class="line">        d[a].push_back((card)&#123;b,c&#125;);</span><br><span class="line">        smx[b]=max(smx[b],c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i=Lb<span class="number">-1</span>;i;--i) smx[i]=max(smx[i],smx[i+<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=Lb;++i) sum[i]=sum[i<span class="number">-1</span>]+smx[i]; <span class="comment">//smx[i]的前缀和</span></span><br><span class="line">    <span class="keyword">int</span> mxb=<span class="number">0</span>,mxc=<span class="number">0</span>,k=Lb+<span class="number">1</span>; <span class="comment">//初始值</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> x=La;x;--x)&#123; <span class="comment">//从大到小枚举</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">register</span> <span class="keyword">int</span> i=<span class="number">0</span>;i&lt;d[x].size();++i)&#123;</span><br><span class="line">            <span class="keyword">int</span> y=d[x][i].b,z=d[x][i].c;</span><br><span class="line">            mxb=max(mxb,y),mxc=max(mxc,z); <span class="comment">//维护mx2和mx3</span></span><br><span class="line">            <span class="keyword">while</span> (k&gt;mxb+<span class="number">1</span>&amp;&amp;smx[k<span class="number">-1</span>]&lt;mxc) --k; <span class="comment">//维护k</span></span><br><span class="line">        &#125;</span><br><span class="line">        k=max(k,mxb+<span class="number">1</span>); <span class="comment">//防止越界</span></span><br><span class="line">        ans+=<span class="number">1l</span>l*(Lc-mxc)*(Lb-k+<span class="number">1</span>)+<span class="number">1l</span>l*Lc*(k-mxb<span class="number">-1</span>)-sum[k<span class="number">-1</span>]+sum[mxb]; <span class="comment">//利用前缀和O(1)统计答案</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>,ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
            <br>
            
  
    
    

<section class="widget text  desktop mobile">
  

  <div class='content'>
    
      <center>
深深明白自己的弱小
</center>

    
  </div>
</section>

  

  
    
    

<section class="widget copyright  desktop mobile">
  <div class='content'>
    
      <blockquote>
        
          
            <p>博客内容遵循 署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</p>

          
        
          
            <p>本文永久链接是：<a href=https://autumnkite.gitee.io/cf815d-sol/>https://autumnkite.gitee.io/cf815d-sol/</a></p>
          
        
      </blockquote>
    
  </div>
</section>

  


          
        </div>
        
          


  <section class='meta' id="footer-meta">
    <div class='new-meta-box'>
      
        
          <div class="new-meta-item date" itemprop="dateUpdated" datetime="2020-03-26T15:22:57+08:00">
  <a class='notlink'>
    <i class="fas fa-edit fa-fw" aria-hidden="true"></i>
    <p>更新于：2020年3月26日</p>
  </a>
</div>

        
      
        
          
  
  <div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E4%B8%89%E7%BB%B4%E6%95%B0%E7%82%B9/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>三维数点</p></a></div> <div class="new-meta-item meta-tags"><a class="tag" href="/tags/%E5%8D%95%E8%B0%83%E6%80%A7/" rel="nofollow"><i class="fas fa-hashtag fa-fw" aria-hidden="true"></i><p>单调性</p></a></div>


        
      
        
          
  <div class="new-meta-item share -mob-share-list">
  <div class="-mob-share-list share-body">
    
      
        <a class="-mob-share-qq" title="" rel="external nofollow noopener noreferrer"
          
          href="http://connect.qq.com/widget/shareqq/index.html?url=https://autumnkite.gitee.io/cf815d-sol/&title=「Codeforces 815D」Karen and Cards - AutumnKite's Blog&summary=题目传送门
Karen and Cards
Karen just got home from the supermarket, and is getting ready to go to sleep."
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qq.png">
          
        </a>
      
    
      
        <a class="-mob-share-qzone" title="" rel="external nofollow noopener noreferrer"
          
          href="https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=https://autumnkite.gitee.io/cf815d-sol/&title=「Codeforces 815D」Karen and Cards - AutumnKite's Blog&summary=题目传送门
Karen and Cards
Karen just got home from the supermarket, and is getting ready to go to sleep."
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/qzone.png">
          
        </a>
      
    
      
        <a class="-mob-share-weibo" title="" rel="external nofollow noopener noreferrer"
          
          href="http://service.weibo.com/share/share.php?url=https://autumnkite.gitee.io/cf815d-sol/&title=「Codeforces 815D」Karen and Cards - AutumnKite's Blog&summary=题目传送门
Karen and Cards
Karen just got home from the supermarket, and is getting ready to go to sleep."
          
          >
          
            <img src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/logo/128/weibo.png">
          
        </a>
      
    
  </div>
</div>



        
      
    </div>
  </section>


        
        
          <div class="prev-next">
            
              <a class='prev' href='/inv-notes/'>
                <p class='title'><i class="fas fa-chevron-left" aria-hidden="true"></i>乘法逆元 学习笔记</p>
                <p class='date'>2018-09-09</p>
              </a>
            
            
          </div>
        
      </section>
    </article>
  

  
    <!-- 显示推荐文章和评论 -->



  <article class="post white-box comments shadow floatable">
    <section class="article typo">
      <p ct><i class='fas fa-comments'></i> 评论</p>
      
        <p cst>如需要头像服务请在「邮箱」中填写 Gravatar 中绑定的邮箱</p>
      
      
      
      
      
        <section id="comments">
          <div id="valine_container" class="valine_thread">
            <i class="fas fa-spinner fa-spin fa-fw"></i>
          </div>
        </section>
      
    </section>
  </article>


  




<!-- 根据页面mathjax变量决定是否加载MathJax数学公式js -->



  <script>
    window.subData = {
      title: '「Codeforces 815D」Karen and Cards',
      tools: true
    }
  </script>


</div>
<aside class='l_side'>
  
  
    
    

<section class="widget blogger shadow floatable desktop mobile">
  <div class='content'>
    
      <div class='avatar'>
        <img class='avatar' src='/files/logo.png'/>
      </div>
    
    
    
      <div class="social-wrapper">
        
          
            <a href="/atom.xml"
              class="social fas fa-rss flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="mailto:1790397194@qq.com"
              class="social fas fa-envelope flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://github.com/AutumnKite"
              class="social fab fa-github flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
          
            <a href="https://www.luogu.com.cn/user/20561"
              class="social fas fa-code flat-btn"
              target="_blank"
              rel="external nofollow noopener noreferrer">
            </a>
          
        
      </div>
    
  </div>
</section>

  

  
    
    <script>
  fetch('https://v1.hitokoto.cn')
    .then(response => response.json())
    .then(data => {
      const hitokoto = document.getElementById('hitokoto'), source = document.getElementById('source');
      hitokoto.innerText = data.hitokoto;
      source.innerText = '——' + data.from;
    })
    .catch(console.error)
</script>


<section class="widget hitokoto shadow floatable desktop mobile">
  
  <header>
    
      <i class="fas fa-quote-left fa-fw" aria-hidden="true"></i><span class='name'>一言（ヒトコト）</span>
    
  </header>


  <div class='content' style="margin-left: 1rem; margin-right: 1rem;">
    <p id="hitokoto" style="text-align: center;"> Loading... </p>
    <p id="source" style="text-align: right; color: gray"></p>
  </div>
</section>

  

  
    
    


  <section class="widget toc-wrapper shadow floatable desktop mobile">
    
  <header>
    
      <i class="fas fa-list fa-fw" aria-hidden="true"></i><span class='name'>本文目录</span>
    
  </header>


    <div class='content'>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#karen-and-cards"><span class="toc-text">Karen and Cards</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#input"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#output"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#examples"><span class="toc-text">Examples</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#input-1"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#output-1"><span class="toc-text">Output</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#input-2"><span class="toc-text">Input</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#output-2"><span class="toc-text">Output</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#note"><span class="toc-text">Note</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#problem"><span class="toc-text">Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#solution"><span class="toc-text">Solution</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#source"><span class="toc-text">Source</span></a></li></ol>
    </div>
  </section>


  


</aside>


  
  <footer class="clearfix">
    <br><br>
    
      
        <br>
        <div class="social-wrapper">
          
            
              <a href="/atom.xml"
                class="social fas fa-rss flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="mailto:1790397194@qq.com"
                class="social fas fa-envelope flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://github.com/AutumnKite"
                class="social fab fa-github flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
            
              <a href="https://www.luogu.com.cn/user/20561"
                class="social fas fa-code flat-btn"
                target="_blank"
                rel="external nofollow noopener noreferrer">
              </a>
            
          
        </div>
      
    
      
        <div><p>博客内容遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener">署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p>
</div>
      
    
      
        本站使用
        <a href="https://volantis.js.org/" target="_blank" class="codename">Volantis</a>
        作为主题
        
          ，
          总访问量为
          <span id="busuanzi_value_site_pv"><i class="fas fa-spinner fa-spin fa-fw" aria-hidden="true"></i></span>
          次
        
      
    
      
        <div class='copyright'>
        <p><a href="/">Copyright © 2017-2020 AutumnKite</a></p>

        </div>
      
    
  </footer>

<script>setLoadingBarProgress(80);</script>


      <script>setLoadingBarProgress(60);</script>
    </div>
    <a class="s-top fas fa-arrow-up fa-fw" href='javascript:void(0)'></a>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4/dist/jquery.min.js"></script>


  <script>
    
    var SEARCH_SERVICE = "hexo" || "hexo";
    var ROOT = "/" || "/";
    if (!ROOT.endsWith('/')) ROOT += '/';
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/instant_page.js" type="module" defer integrity="sha384-OeDn4XE77tdHo8pGtE1apMPmAipjoxUQ++eeJa6EtJCfHlvijigWiJpD7VDPWXV1"></script>



  
<script src="https://cdn.jsdelivr.net/npm/node-waves@0.7.6/dist/waves.min.js"></script>

  <script type="text/javascript">
    $(function() {
      Waves.attach('.flat-btn', ['waves-button']);
      Waves.attach('.float-btn', ['waves-button', 'waves-float']);
      Waves.attach('.float-btn-light', ['waves-button', 'waves-float', 'waves-light']);
      Waves.attach('.flat-box', ['waves-block']);
      Waves.attach('.float-box', ['waves-block', 'waves-float']);
      Waves.attach('.waves-image');
      Waves.init();
    });
  </script>


  <script async src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-busuanzi@2.3/js/busuanzi.pure.mini.js"></script>



  
  
  
    
<script src="https://cdn.jsdelivr.net/npm/jquery-backstretch@2.1.18/jquery.backstretch.min.js"></script>

    <script type="text/javascript">
      $(function(){
        var imgs=["https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg", "https://cdn.jsdelivr.net/gh/xaoxuu/cdn-wallpaper/abstract/B18FCBB3-67FD-48CC-B4F3-457BA145F17A.jpeg"];
        if ('true' == 'true') {
          function shuffle(arr){
            /*From countercurrent-time*/
            var n = arr.length;
            while(n--) {
              var index = Math.floor(Math.random() * n);
              var temp = arr[index];
              arr[index] = arr[n];
              arr[n] = temp;
            }
          }
          shuffle(imgs);
        }
        if ('.cover') {
          $('.cover').backstretch(
            imgs,
          {
            duration: "10000",
            fade: "1500"
          });
        } else {
          $.backstretch(
            imgs,
          {
            duration: "10000",
            fade: "1500"
          });
        }
      });
    </script>
  










  
    
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.2.0/js/valine.js"></script>

  
  <script>
  var GUEST_INFO = ['nick','mail','link'];
  var guest_info = 'nick,mail,link'.split(',').filter(function(item){
    return GUEST_INFO.indexOf(item) > -1
  });
  var notify = 'false' == true;
  var verify = 'true' == true;
  var valine = new Valine();
  valine.init({
    el: '#valine_container',
    notify: notify,
    verify: verify,
    guest_info: guest_info,
    
    appId: "GJE8Kk4pgTCYuIqXF3WXSlIx-gzGzoHsz",
    appKey: "0e7osi2V14c1UISzsffaEtQs",
    placeholder: "快来评论吧~",
    pageSize:'20',
    avatar:'mp',
    lang:'zh-cn',
    visitor: 'false',
    highlight:'true'
  })
  </script>



  
<script src="/js/app.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2.1/js/search.js"></script>



  
<script src="https://cdn.jsdelivr.net/gh/xaoxuu/cdn-volantis@2/js/comment_typing.js"></script>



<!-- 复制 -->

  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="fas fa-copy"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copyed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-clipboard-check');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPYED';
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('fa-copy');
        $icon.addClass('fa-exclamation-triangle');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
      });
    }
    initCopyCode();
  }(window, document);
</script>




<!-- fancybox -->

  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script>
  let LAZY_LOAD_IMAGE = "";
  $(".article-entry").find("div.fancybox").find("img").each(function () {
      var element = document.createElement("a");
      $(element).attr("data-fancybox", "gallery");
      $(element).attr("href", $(this).attr("src"));
      /* 图片采用懒加载处理时,
       * 一般图片标签内会有个属性名来存放图片的真实地址，比如 data-original,
       * 那么此处将原本的属性名src替换为对应属性名data-original,
       * 修改如下
       */
       if (LAZY_LOAD_IMAGE) {
         $(element).attr("href", $(this).attr("data-original"));
       }
      $(this).wrap(element);
  });
</script>






  <script>setLoadingBarProgress(100);</script>
</body>
</html>
